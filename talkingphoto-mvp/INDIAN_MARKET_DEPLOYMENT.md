# TalkingPhoto MVP - Indian Market Deployment Guide

## Overview

This guide provides step-by-step instructions for deploying TalkingPhoto MVP in the Indian market with optimized payment processing, local compliance, and UPI integration.

## üáÆüá≥ Indian Market Features

### Payment Methods
- ‚úÖ **UPI**: Google Pay, PhonePe, Paytm, BHIM
- ‚úÖ **Cards**: Visa, Mastercard, RuPay, Amex
- ‚úÖ **Net Banking**: All major Indian banks
- ‚úÖ **Wallets**: Paytm, Mobikwik, Freecharge, Amazon Pay

### Pricing (INR)
- üÜì **Free Trial**: 3 videos, ‚Çπ0/month
- üíé **Basic Plan**: 30 videos, ‚Çπ999/month (‚Çπ9,999/year)
- ‚ö° **Pro Plan**: 100 videos, ‚Çπ2,999/month (‚Çπ29,999/year)
- üè¢ **Enterprise**: 500 videos, ‚Çπ9,999/month (‚Çπ99,999/year)

### Compliance
- ‚úÖ **GST**: 18% automatic calculation
- ‚úÖ **Invoicing**: GST-compliant invoices
- ‚úÖ **Data Privacy**: GDPR + Indian data laws
- ‚úÖ **Support**: Hindi + English languages

## üìã Prerequisites

### Required Accounts
1. **Stripe Account** with India payments enabled
2. **Domain**: preferably .in domain for trust
3. **SSL Certificate** for secure payments
4. **Business Registration** in India (for GST)

### Environment Setup
```bash
# Clone repository
git clone <repository-url>
cd talkingphoto-mvp

# Install dependencies
pip install -r requirements.txt

# Create environment file
cp .env.example .env
```

## ‚öôÔ∏è Step 1: Stripe Setup for India

### 1.1 Enable Indian Payment Methods
```bash
# Login to Stripe Dashboard
# Go to Settings > Payment Methods
# Enable: Cards, UPI, Net Banking, Wallets
```

### 1.2 Configure Business Profile
```bash
# Business Type: Technology/Software
# Industry: SaaS/Digital Services
# Country: India
# Currency: INR (Indian Rupee)
# GST Number: Your business GST number
```

### 1.3 Automated Setup
```bash
# Set your Stripe keys in .env
STRIPE_SECRET_KEY=sk_live_your_secret_key
STRIPE_PUBLISHABLE_KEY=pk_live_your_publishable_key

# Run automated setup
python setup_indian_payments.py https://yourdomain.in

# This will create:
# - Products for all pricing tiers
# - INR prices for monthly/yearly billing
# - Webhook endpoints
# - Tax configuration (18% GST)
# - Test customers
```

## ‚öôÔ∏è Step 2: Environment Configuration

### 2.1 Update .env File
```env
# Stripe Configuration
STRIPE_PUBLISHABLE_KEY=pk_live_your_publishable_key
STRIPE_SECRET_KEY=sk_live_your_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# Indian Market Pricing (Generated by setup script)
STRIPE_BASIC_MONTHLY_PRICE_ID_INR=price_xxx
STRIPE_BASIC_YEARLY_PRICE_ID_INR=price_xxx
STRIPE_PRO_MONTHLY_PRICE_ID_INR=price_xxx
STRIPE_PRO_YEARLY_PRICE_ID_INR=price_xxx
STRIPE_ENTERPRISE_MONTHLY_PRICE_ID_INR=price_xxx
STRIPE_ENTERPRISE_YEARLY_PRICE_ID_INR=price_xxx

# Indian Configuration
STRIPE_CURRENCY=inr
STRIPE_COUNTRY=IN
STRIPE_LOCALE=hi
GST_RATE=18
HSN_CODE=998313

# Company Details (for invoicing)
COMPANY_NAME=Your Company Name Pvt Ltd
COMPANY_GSTIN=29AABCT1332L000
COMPANY_PAN=AABCT1332L
COMPANY_ADDRESS=Your Complete Address, City, State, PIN

# URLs
STRIPE_SUCCESS_URL=https://yourdomain.in/payment/success
STRIPE_CANCEL_URL=https://yourdomain.in/payment/cancel
DOMAIN_URL=https://yourdomain.in

# Support
SUPPORT_EMAIL=support@yourdomain.in
SUPPORT_PHONE=+91-80-1234-5678
WHATSAPP_SUPPORT=+91-98765-43210
```

### 2.2 Localization Settings
```env
# Language & Region
DEFAULT_LANGUAGE=en
SUPPORTED_LANGUAGES=en,hi
TIMEZONE=Asia/Kolkata
CURRENCY_SYMBOL=‚Çπ
DATE_FORMAT=DD/MM/YYYY

# Indian Banking
IFSC_VALIDATION=true
PAN_VALIDATION=true
AADHAAR_VALIDATION=false  # Optional
```

## üöÄ Step 3: Application Deployment

### 3.1 Local Development
```bash
# Start the application
streamlit run app.py --server.port 8501

# Start webhook server (separate terminal)
python -m services.webhook_service

# Test payments
# Use test cards: 4000 0035 6000 0008 (Indian Visa)
# Use test UPI: success@razorpay
```

### 3.2 Production Deployment

#### Option A: Streamlit Cloud
```bash
# 1. Push to GitHub
git add .
git commit -m "Indian market payment integration"
git push origin main

# 2. Deploy to Streamlit Cloud
# - Connect GitHub repository
# - Set environment variables in Streamlit Cloud dashboard
# - Deploy with custom domain
```

#### Option B: AWS/GCP/Azure
```bash
# 1. Build Docker image
docker build -t talkingphoto-mvp .

# 2. Deploy to cloud provider
# Configure load balancer for webhook endpoints
# Set up SSL certificate
# Configure environment variables
```

#### Option C: VPS/Dedicated Server
```bash
# 1. Setup server
sudo apt update && sudo apt upgrade -y
sudo apt install python3 python3-pip nginx certbot -y

# 2. Clone and setup
git clone <repository-url>
cd talkingphoto-mvp
pip3 install -r requirements.txt

# 3. Configure Nginx
sudo nano /etc/nginx/sites-available/talkingphoto
# Add configuration from deployment guide

# 4. SSL Certificate
sudo certbot --nginx -d yourdomain.in -d www.yourdomain.in

# 5. Start services
# Streamlit app
nohup streamlit run app.py --server.port 8501 &

# Webhook server
nohup python -m services.webhook_service &
```

### 3.3 Nginx Configuration
```nginx
server {
    listen 443 ssl;
    server_name yourdomain.in www.yourdomain.in;

    ssl_certificate /etc/letsencrypt/live/yourdomain.in/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/yourdomain.in/privkey.pem;

    # Streamlit app
    location / {
        proxy_pass http://localhost:8501;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Webhook endpoints
    location /webhook/ {
        proxy_pass http://localhost:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# Redirect HTTP to HTTPS
server {
    listen 80;
    server_name yourdomain.in www.yourdomain.in;
    return 301 https://$server_name$request_uri;
}
```

## üß™ Step 4: Testing

### 4.1 Payment Testing
```python
# Test Indian cards
test_cards = {
    "visa_india": "4000 0035 6000 0008",
    "mastercard_india": "5555 5555 5555 4444",
    "rupay": "6521 1111 1111 1117",
    "declined": "4000 0000 0000 0002"
}

# Test UPI
test_upi = {
    "success": "success@razorpay",
    "failure": "failure@razorpay"
}
```

### 4.2 Webhook Testing
```bash
# Install Stripe CLI
curl -s https://packages.stripe.com/api/security/keypair/stripe-cli-gpg/public | gpg --dearmor | sudo tee /usr/share/keyrings/stripe.gpg
echo "deb [signed-by=/usr/share/keyrings/stripe.gpg] https://packages.stripe.com/stripe-cli-debian-local stable main" | sudo tee -a /etc/apt/sources.list.d/stripe.list
sudo apt update && sudo apt install stripe

# Forward webhooks to local
stripe login
stripe listen --forward-to localhost:5001/webhook/stripe

# Test webhook events
stripe trigger checkout.session.completed
stripe trigger payment_intent.succeeded
```

### 4.3 End-to-End Testing Checklist

#### Free Trial Sign-up
- [ ] User can sign up for free trial
- [ ] Receives 3 free credits
- [ ] Can create videos without payment
- [ ] Gets upgrade prompts after credits exhausted

#### Basic Plan Subscription
- [ ] Monthly ‚Çπ999 payment works with all methods
- [ ] Yearly ‚Çπ9,999 payment works (saves ‚Çπ2,000)
- [ ] User receives 30 credits immediately
- [ ] Credits reset monthly
- [ ] GST invoice generated automatically

#### Pro Plan Subscription
- [ ] Monthly ‚Çπ2,999 payment processes
- [ ] Yearly ‚Çπ29,999 payment processes
- [ ] User receives 100 credits
- [ ] All pro features unlocked

#### UPI Payments
- [ ] QR code generation works
- [ ] UPI deep links work on mobile
- [ ] Payment completion redirects properly
- [ ] Webhook processes UPI payments

#### Failed Payments
- [ ] Retry logic triggers automatically
- [ ] Dunning emails sent appropriately
- [ ] Grace period implemented
- [ ] User downgraded after exhaustion

#### Subscription Management
- [ ] Users can upgrade/downgrade
- [ ] Cancellation works with retention offers
- [ ] Pausing subscriptions works
- [ ] Prorations calculated correctly

## üìä Step 5: Monitoring & Analytics

### 5.1 Payment Analytics
```python
# Monitor key metrics
metrics_to_track = [
    "conversion_rate_by_payment_method",
    "upi_vs_card_preference",
    "retry_success_rate",
    "churn_rate_by_tier",
    "ltv_by_region",
    "failed_payment_reasons"
]
```

### 5.2 Set up Dashboards
- **Stripe Dashboard**: Revenue, failed payments, disputes
- **Google Analytics**: User flow, conversion funnels
- **Custom Dashboard**: Credit usage, feature adoption

## üõ°Ô∏è Step 6: Compliance & Legal

### 6.1 Data Protection
- Implement GDPR-compliant data handling
- Add privacy policy for Indian users
- Set up data retention policies
- Configure cookie consent

### 6.2 Financial Compliance
- Register for GST if applicable
- Set up accounting for digital services
- Maintain transaction records
- Comply with RBI guidelines for digital payments

### 6.3 Customer Support
- Set up Hindi language support
- WhatsApp Business integration
- India-specific FAQ section
- Local business hours support

## üö® Step 7: Go-Live Checklist

### Pre-Launch
- [ ] All test payments successful
- [ ] Webhooks processing correctly
- [ ] SSL certificate installed
- [ ] Domain configured properly
- [ ] GST registration complete
- [ ] Support channels active

### Launch Day
- [ ] Monitor payment success rates
- [ ] Watch for webhook errors
- [ ] Check customer support tickets
- [ ] Monitor server performance
- [ ] Track user sign-ups and conversions

### Post-Launch (Week 1)
- [ ] Review payment analytics
- [ ] Analyze user feedback
- [ ] Monitor support ticket themes
- [ ] Check failed payment patterns
- [ ] Review retry success rates
- [ ] Optimize based on data

## üîß Troubleshooting Common Issues

### Payment Failures
```bash
# Check Stripe logs
stripe logs tail --filter type=payment_intent

# Common solutions:
# 1. Verify webhook signatures
# 2. Check payment method availability
# 3. Validate currency settings
# 4. Confirm GST configuration
```

### UPI Issues
- Ensure merchant account supports UPI
- Check UPI app compatibility
- Verify QR code generation
- Test mobile deep links

### Webhook Problems
- Validate endpoint URL accessibility
- Check SSL certificate validity
- Verify signature validation
- Monitor response times

## üìû Support & Resources

### Documentation
- [Stripe India Docs](https://stripe.com/docs/payments/accept-a-payment?platform=web&ui=checkout#india)
- [UPI Payment Guide](https://stripe.com/docs/payments/upi)
- [Indian Tax Configuration](https://stripe.com/docs/tax/india)

### Support Channels
- **Email**: support@yourdomain.in
- **WhatsApp**: +91-98765-43210
- **Phone**: +91-80-1234-5678
- **Hours**: 9 AM - 6 PM IST (Mon-Fri)

### Emergency Contacts
- **Technical Issues**: tech@yourdomain.in
- **Payment Issues**: payments@yourdomain.in
- **Business Inquiries**: business@yourdomain.in

---

## üéä Congratulations!

Your TalkingPhoto MVP is now optimized for the Indian market with:
- ‚Çπ999/‚Çπ2,999/‚Çπ9,999 pricing tiers
- UPI, cards, and wallet payments
- GST compliance and invoicing
- Hindi localization
- Comprehensive retry logic
- Indian customer support

**Expected Results:**
- 40-60% higher conversion with UPI
- 25-30% better retention with local pricing
- 90%+ payment success rate with retry logic
- Compliance with Indian regulations

Start monitoring your metrics and iterate based on user feedback!

---

*Last Updated: September 2024*
*Version: 1.0*